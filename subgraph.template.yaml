specVersion: 0.0.3
description: Phuture
repository: https://github.com/Phuturedao/phuture-subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: IndexRegistry
    network: {{network}}
    source:
      abi: IndexRegistry
      address: '{{indexRegistryContractAddress}}'
      startBlock: {{indexRegistryStartBlock}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Asset
        - Stat
      abis:
        - name: IndexRegistry
          file: ./abis/IndexRegistry.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: RemoveAsset(address,indexed address)
          handler: handleRemoveAsset
        - event: UpdateAsset(address,indexed address,uint256)
          handler: handleUpdateAsset
      file: ./src/mappings/indexRegistry.ts
  - kind: ethereum/contract
    name: Index
    network: {{network}}
    source:
      abi: StaticIndexFactory
      address: '{{indexFactoryContractAddress}}'
      startBlock: {{indexFactoryStartBlock}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Index
        - IndexAsset
      abis:
        - name: StaticIndexFactory
          file: ./abis/StaticIndexFactory.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: IndexCreated(address,address[],uint8[],uint256)
          handler: handleIndexCreated
      file: ./src/mappings/staticIndexFactory.ts
  - kind: ethereum/contract
    name: Vault
    network: {{network}}
    source:
      abi: Vault
      address: '{{vaultContractAddress}}'
      startBlock: {{vaultStartBlock}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Asset
        - Index
        - IndexAsset
      abis:
        - name: Vault
          file: ./abis/Vault.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/mappings/vault.ts
  - kind: ethereum/contract
    name: UniswapFactory
    network: {{network}}
    source:
      abi: UniswapFactory
      address: '{{uniswapFactoryContractAddress}}'
      startBlock: {{uniswapFactoryStartBlock}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Pair
        - Asset
      abis:
        - name: UniswapFactory
          file: ./abis/UniswapFactory.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: ERC20SymbolBytes
          file: ./abis/ERC20SymbolBytes.json
        - name: ERC20NameBytes
          file: ./abis/ERC20NameBytes.json
      eventHandlers:
        - event: PairCreated(indexed address,indexed address,address,uint256)
          handler: handleNewPair
      file: ./src/mappings/uniswap.ts
  - kind: ethereum/contract
    name: LiquidityMining
    network: {{network}}
    source:
      abi: LiquidityMining
      address: '{{liquidityMiningContractAddress}}'
      startBlock: {{liquidityMiningStartBlock}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - VestingRange
      abis:
        - name: LiquidityMining
          file: ./abis/LiquidityMining.json
      eventHandlers:
        - event: Stake(indexed address,uint256,indexed uint8,indexed uint8)
          handler: handleStake
        - event: UnstakeRange(indexed address,uint256,indexed uint8,indexed uint8)
          handler: handleUnstake
      file: ./src/mappings/liquidityMining.ts
  - kind: ethereum/contract
    name: ChainLink
    network: rinkeby
    source:
      abi: ChainLink
      address: '{{chainLinkAddress}}'
      startBlock: 9004812
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/chainlink.ts
      entities:
        - Asset
        - DailyAssetStat
      abis:
        - name: ChainLink
          file: ./abis/ChainLink.json
      eventHandlers:
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred

templates:
  - kind: ethereum/contract
    name: Asset
    network: {{network}}
    source:
      abi: Asset
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/indexRegistry.ts
      entities:
        - Asset
      abis:
        - name: Asset
          file: ./abis/ERC20.json
            #  - name: StaticIndex
            #    file: ./abis/StaticIndex.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
  - kind: ethereum/contract
    name: StaticIndex
    network: {{network}}
    source:
      abi: StaticIndex
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/staticIndex.ts
      entities:
        - Index
        - Asset
        - DailyIndexStat
      abis:
        - name: IndexRegistry
          file: ./abis/IndexRegistry.json
        - name: StaticIndexFactory
          file: ./abis/StaticIndexFactory.json
        - name: StaticIndex
          file: ./abis/StaticIndex.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
        - event: SetImageURL(indexed address,string)
          handler: handleSetImageURL
        - event: SetName(indexed address,string)
          handler: handleSetName
        - event: SetSymbol(indexed address,string)
          handler: handleSetSymbol
  - kind: ethereum/contract
    name: UniswapPair
    network: {{network}}
    source:
      abi: UniswapPair
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/uniswap.ts
      entities:
        - Asset
        - Pair
      abis:
        - name: UniswapPair
          file: ./abis/UniswapPair.json
        - name: UniswapFactory
          file: ./abis/UniswapFactory.json
      eventHandlers:
        - event: Sync(uint112,uint112)
          handler: handleSync
